<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Usage of mrgvalprep and mrgvalidate • mrgvalprep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Usage of mrgvalprep and mrgvalidate">
<meta property="og:description" content="mrgvalprep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mrgvalprep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_usage.html">Basic Usage of mrgvalprep and mrgvalidate</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/metrumresearchgroup/mrgvalprep">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Usage of mrgvalprep and mrgvalidate</h1>
            
      
      
      <div class="hidden name"><code>basic_usage.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>mrgvalprep</code> package contains helper functions for gathering, formatting, and preprocessing input data for <code>mrgvalidate</code>. The <code>mrgvalidate</code> package is used specifically to generate three documents that are necessary for the software validation process at Mertrum Research Group. Those documents are:</p>
<ul>
<li><code>requirements-specification.docx</code></li>
<li><code>validation-testing.docx</code></li>
<li><code>traceability-matrix.docx</code></li>
</ul>
<p>This vignette demonstrates some of the primary functionality for using <code>mrgvalprep</code> to validate an R package and build validation docs from content stored in either Github issues or Googlesheets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mrgvalprep</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mrgvalidate</span><span class="op">)</span></code></pre></div>
</div>
<div id="mrgvalidate-inputs" class="section level1">
<h1 class="hasAnchor">
<a href="#mrgvalidate-inputs" class="anchor"></a><code>mrgvalidate</code> inputs</h1>
<p><code>mrgvalidate</code> requires two primary inputs:</p>
<ul>
<li>A directory of test outputs (<code>.csv</code> and <code>.json</code> files, described below)</li>
<li>A tibble of user stories and, optionally, technical requirements</li>
</ul>
<p><strong>These inputs <em>must</em> be in the format described in <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/input_formats.html">?mrgvalidate::input_formats</a>.</strong> The purpose of <code>mrgvalprep</code> is to take test outputs and stories from a variety of formats and transform them into the format that <code>mrgvalidate</code> expects.</p>
<p>Below we show a few examples of how to do this.</p>
<ul>
<li><a href="#example1">Example 1: Automated and Manual Tests, with Stories from Googlesheets</a></li>
<li><a href="#example2">Example 2: An R package on Github, with Stories from Github Issues</a></li>
</ul>
</div>
<div id="example1" class="section level1">
<h1 class="hasAnchor">
<a href="#example1" class="anchor"></a>Example 1: Automated and Manual Tests, with Stories from Googlesheets</h1>
<p>This example shows how to validate software that contains both automated <em>and</em> manual tests, as well as how to pull Stories and Requirements from Googlesheets.</p>
<p>The full code (replicated in each section below) is included here for ease of reference. See below for details about each of these functions and their inputs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># run automated test suite</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/test.html">test</a></span><span class="op">(</span>reporter <span class="op">=</span> <span class="fu">testthat</span><span class="fu">::</span><span class="va"><a href="https://testthat.r-lib.org/reference/ListReporter.html">ListReporter</a></span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># run testthat tests suite</span>
  <span class="fu">mrgvalprep</span><span class="fu">::</span><span class="fu"><a href="../reference/parse_testthat_list_reporter.html">parse_testthat_list_reporter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>      <span class="co"># parse test results to tibble</span>
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="st">"auto_tests/test_res.csv"</span><span class="op">)</span>         <span class="co"># write tibble for .csv file</span>

<span class="co"># capture system information for test suite run</span>
<span class="fu"><a href="../reference/get_sys_info.html">get_sys_info</a></span><span class="op">(</span>
  out_path <span class="op">=</span> <span class="st">"auto_tests/test_res.json"</span>,
  env_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"METWORX_AMI_VERSION"</span><span class="op">)</span>,    <span class="co"># optionally pull with Sys.getenv() and include in .json</span>
  sys_info <span class="op">=</span> <span class="cn">TRUE</span>                         <span class="co"># optionally write results of Sys.info() to .json</span>
<span class="op">)</span>

<span class="co"># pull stories and requirements from googlesheets</span>
<span class="va">stories_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_spec_gsheets.html">read_spec_gsheets</a></span><span class="op">(</span>
  ss_stories <span class="op">=</span> <span class="st">"1HgsxL4qfYK-wjB-nloMilQiuBSLV6FZq_h2ToB6QNlI"</span>, <span class="co"># the sheet with Stories</span>
  ss_req <span class="op">=</span> <span class="st">"1SnyUzxVDUUJFtMGEi2x4zJE0iB2JDV1Np-ivhaUkODk"</span>      <span class="co"># the (optional) sheet with Requirements</span>
<span class="op">)</span>

<span class="co"># create validation documents</span>
<span class="fu">mrgvalidate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mrgvalidate/man/create_validation_docs.html">create_validation_docs</a></span><span class="op">(</span>
  <span class="st">"fake Googlesheets product"</span>,      <span class="co"># name of the product or package you are validating</span>
  <span class="st">"vFake"</span>,                          <span class="co"># version number for this validation (to be printed in docs)</span>
  <span class="va">stories_df</span>,                       <span class="co"># tibble of stories from `read_spec_gsheets()`</span>
  auto_test_dir <span class="op">=</span> <span class="st">"auto_tests"</span>,     <span class="co"># dir containing .csv and .json files for automated test outputs</span>
  man_test_dir <span class="op">=</span> <span class="st">"man_tests"</span>,       <span class="co"># dir containing manual test outputs</span>
  output_dir <span class="op">=</span> <span class="st">"some_dir_for_docs"</span>  <span class="co"># dir to write validation docs into</span>
<span class="op">)</span></code></pre></div>
<div id="test-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#test-outputs" class="anchor"></a>Test outputs</h2>
<p>This section shows how to include the results of both automated and manual tests in your validation documents. It is never required (by the package) to use <em>both</em> of these. You can use either one or both as is appropriate for the software you’re validating.</p>
<div id="automated-test-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#automated-test-outputs" class="anchor"></a>Automated test outputs</h3>
<p>The format required for automated test outputs is described in <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/input_formats.html">?mrgvalidate::input_formats</a>.</p>
<p>Note that <code>mrgvalidate</code> can accept test outputs from an arbitrary number of test suites for a single set of validation documents. If you have more than one relevant test suite, simply repeat the steps below for each suite and include the <code>.csv</code> and <code>.json</code> files for all of them in the same directory.</p>
<div id="testthat-outputs" class="section level4">
<h4 class="hasAnchor">
<a href="#testthat-outputs" class="anchor"></a><code>testthat</code> outputs</h4>
<p>Currently, <code>mrgvalprep</code> only has a formatter for R’s <code>testthat</code> package (<a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/parse_testthat_list_reporter.html"><code>parse_testthat_list_reporter()</code></a>), though we are planning to add more functions to take the output from other test frameworks (for example <code>go test --json</code> output) and return a tibble that conforms to <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/input_formats.html">?mrgvalidate::input_formats</a>.</p>
<p>To create test outputs from an R package using <code>testthat</code>, navigate to your package directory and run to following.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/test.html">test</a></span><span class="op">(</span>reporter <span class="op">=</span> <span class="fu">testthat</span><span class="fu">::</span><span class="va"><a href="https://testthat.r-lib.org/reference/ListReporter.html">ListReporter</a></span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># run testthat tests suite</span>
  <span class="fu">mrgvalprep</span><span class="fu">::</span><span class="fu"><a href="../reference/parse_testthat_list_reporter.html">parse_testthat_list_reporter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>      <span class="co"># parse test results to tibble</span>
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="st">"auto_tests/test_res.csv"</span><span class="op">)</span>         <span class="co"># write tibble for .csv file</span></code></pre></div>
<p>This will run your full test suite, format the output appropriately, and then write the formatted output to a <code>.csv</code> for <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a> to consume.</p>
</div>
<div id="test-ids" class="section level4">
<h4 class="hasAnchor">
<a href="#test-ids" class="anchor"></a>Test Id’s</h4>
<p>For these tests to be mapped to the Stories described below, they will need to contain Test Id’s. This is simply a string that uniquely identifies each test. These Id’s will look like <code>ABC-XYZ-001</code> and contain the following three pieces, separated by a hypen (<code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code>):</p>
<ul>
<li>Any number of capital letters (typically identifies the test suite)</li>
<li>Any number of capital letters (typically identifies some category, for example <code>CFG</code> for “configuration”)</li>
<li>Any number of integers, optionally zero-padded for readability</li>
</ul>
<p>These <em>must</em> be included, with square brackets, in the Test Name of any test that will be mapped to a Story. For example:</p>
<pre><code>test_that("feature X works correctly [MRGV-CFG-001]", {
  # test code
})</code></pre>
<p>In this case, <code>MRGV-CFG-001</code> will automatically be parsed out by <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/parse_testthat_list_reporter.html"><code>parse_testthat_list_reporter()</code></a> and will be matched against any Stories or Requirements containing <code>MRGV-CFG-001</code> in the <code>TestIds</code> column described below.</p>
</div>
<div id="system-information" class="section level4">
<h4 class="hasAnchor">
<a href="#system-information" class="anchor"></a>System information</h4>
<p>It is typically necessary to capture some system information about where and when the tests were run. This is passed to <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a> via a <code>.json</code> file that can be easily created with <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/get_sys_info.html"><code>get_sys_info()</code></a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_sys_info.html">get_sys_info</a></span><span class="op">(</span>
  out_path <span class="op">=</span> <span class="st">"auto_tests/test_res.json"</span>,
  env_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"METWORX_AMI_VERSION"</span><span class="op">)</span>,    <span class="co"># optionally pull with Sys.getenv() and include in .json</span>
  sys_info <span class="op">=</span> <span class="cn">TRUE</span>                         <span class="co"># optionally write results of Sys.info() to .json</span>
<span class="op">)</span></code></pre></div>
<p><em>Note:</em> <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a> will expect to find a <code>.csv</code> and <code>.json</code> with the same basename for each test suite, so be sure that what you pass to <code>create_sys_info(out_path)</code> matches the <code>.csv</code> of test ouputs that you wrote in the previous section.</p>
</div>
</div>
<div id="manual-test-results" class="section level3">
<h3 class="hasAnchor">
<a href="#manual-test-results" class="anchor"></a>Manual test results</h3>
<p>Sometimes manual tests are required to fully validate your software. <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a> allows you to pass a directory containing <code>.md</code> files which contain the “results” of these manual tests (typically things like screenshots and accompanying narratives). The required format for this directory, as well as the <code>.md</code> and image files in it, is described in <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/input_formats.html#arguments"><code>?mrgvalidate::input_formats</code></a>.</p>
</div>
</div>
<div id="stories-from-googlesheets" class="section level2">
<h2 class="hasAnchor">
<a href="#stories-from-googlesheets" class="anchor"></a>Stories from Googlesheets</h2>
<p>The validation process typically requires defining “user stories” that capture the promised functionality of the software, and mapping them to tests that verify this functionality. The easist way to do this with <code>mrgvalidate</code> is by keeping your Stories (and optionally accompanying Technical Requirements) in a Googlesheet that can be read in directly using <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/read_spec_gsheets.html"><code>read_spec_gsheets()</code></a>.</p>
<p>The format of these Googlesheets is described in <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/read_spec_gsheets.html#details">the <code>read_spec_gsheets()</code> docs</a>. At a high-level, the Stories sheet must have the following columns:</p>
<ul>
<li>
<code>StoryId</code> – Unique identifier for the Story.</li>
<li>
<code>StoryName</code> – Short human-readable name for the Story, to be printed in resulting docs.</li>
<li>
<code>StoryDescription</code> – Short description of the Story, typically beginning with something like “As a user…”.</li>
<li>
<code>ProductRisk</code> – Label that conveys the level of product risk associated with this Story, typically “Low”, “Medium”, or “High”.</li>
<li>Either <code>TestIds</code> or <code>RequirementIds</code> – Comma separated list of Id’s for mapping Story to any associated tests or Technical Requirements.</li>
</ul>
<div id="requirements" class="section level4">
<h4 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h4>
<p>While Stories can be mapped directly to tests, it is often useful to instead map them to associated Technical Requirements, which are then mapped to specific tests. If you want to do this, you will need to include the <code>RequirementIds</code> column (and <em>not</em> the <code>TestIds</code> column) in your Stories Googlesheet, and then pass a second Googlesheet of Requirements with the following columns:</p>
<ul>
<li>
<code>RequirementId</code> – Unique identifier for the Requirement. These must match what is included in the <code>RequirementIds</code> column of the Stories Googlesheet.</li>
<li>
<code>RequirementDescription</code> – Short description of the Requirement, to be printed in resulting docs.</li>
<li>
<code>TestIds</code> – Comma separated list of Test Id’s for mapping Requirement to any associated tests.</li>
</ul>
<p>These Requirements will be included, bullet-pointed, under the relevant Stories in the resulting <code>requirements-specification.docx</code> document.</p>
<p><em>Note:</em> <strong>If you do not want to use Requirements</strong> in your validation, simply pass a Stories sheet containing a <code>TestIds</code> column and <em>not</em> a <code>RequirementIds</code> column.</p>
<p>Calling <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/read_spec_gsheets.html"><code>read_spec_gsheets()</code></a> will pull the data in your sheet(s) into a tibble that can be passed directly to <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stories_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_spec_gsheets.html">read_spec_gsheets</a></span><span class="op">(</span>
  ss_stories <span class="op">=</span> <span class="st">"1HgsxL4qfYK-wjB-nloMilQiuBSLV6FZq_h2ToB6QNlI"</span>, <span class="co"># the sheet with Stories</span>
  ss_req <span class="op">=</span> <span class="st">"1SnyUzxVDUUJFtMGEi2x4zJE0iB2JDV1Np-ivhaUkODk"</span>      <span class="co"># the (optional) sheet with Requirements</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
<div id="generating-the-docs" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-the-docs" class="anchor"></a>Generating the docs</h2>
<p>Now that you have test outputs and a tibble of Stories, you are ready to generate your validation documents. This is done with <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
<p>You will have <code>.csv</code> and <code>.json</code> files of automated test outputs, from your <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/validate_tests.html"><code>validate_tests()</code></a> call above, in the <code>auto_tests</code> directory, as well as <code>.md</code> capturing your manual tests in the <code>man_tests</code> directory. Simply pass these paths, along with your tibble of Stories, into <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mrgvalidate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mrgvalidate/man/create_validation_docs.html">create_validation_docs</a></span><span class="op">(</span>
  <span class="st">"fake Googlesheets product"</span>,      <span class="co"># name of the product or package you are validating</span>
  <span class="st">"vFake"</span>,                          <span class="co"># version number for this validation (to be printed in docs)</span>
  <span class="va">stories_df</span>,                       <span class="co"># tibble of stories from `read_spec_gsheets()`</span>
  auto_test_dir <span class="op">=</span> <span class="st">"auto_tests"</span>,     <span class="co"># dir containing .csv and .json files for automated test outputs</span>
  man_test_dir <span class="op">=</span> <span class="st">"man_tests"</span>,       <span class="co"># dir containing manual test outputs</span>
  output_dir <span class="op">=</span> <span class="st">"some_dir_for_docs"</span>  <span class="co"># dir to write validation docs into</span>
<span class="op">)</span></code></pre></div>
<p>This will write out three <code>.docx</code> files, as well as the <code>.md</code> files that are used to render each, into the directory passed to <code>output_dir</code>.</p>
<ul>
<li><code>validation-testing.docx</code></li>
<li><code>requirements-specification.docx</code></li>
<li><code>traceability-matrix.docx</code></li>
</ul>
<p>If these three documents look correct after human inspection, you’re done!</p>
<p><em>Formatting note:</em> You may want to manually adjust the column widths of the tables in these documents for better readability, especially so that each “Test Id” column value is on its own line. Unfortunately, it is not possible to programmatically specify these column widths. However, it is possible to pass <code>.docx</code> “style reference templates” via the <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html#arguments"><code>style_dir</code> argument</a> to <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
</div>
</div>
<div id="example2" class="section level1">
<h1 class="hasAnchor">
<a href="#example2" class="anchor"></a>Example 2: An R package on Github, with Stories from Github Issues</h1>
<p>This example shows how to validate an R package that is:</p>
<ul>
<li>stored in a Github repo</li>
<li>uses R’s <code>testthat</code> framework</li>
<li>has Stories defined in Github issues</li>
</ul>
<div id="full-code-for-reference" class="section level3">
<h3 class="hasAnchor">
<a href="#full-code-for-reference" class="anchor"></a>Full code for reference</h3>
<p>The full code (replicated in each section below) is included here for ease of reference. See below for details about each of these functions and their inputs.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run test suite to generate test outputs</span>
<span class="fu"><a href="../reference/validate_tests.html">validate_tests</a></span><span class="op">(</span>
  org <span class="op">=</span> <span class="st">"metrumresearchgroup"</span>,        <span class="co"># Github organization containing repo that will be validated</span>
  repo <span class="op">=</span> <span class="st">"mrgvalidatetestreference"</span>,  <span class="co"># repo for fake package used by mrgvalprep test suite</span>
  version <span class="op">=</span> <span class="st">"0.6.0"</span>,                  <span class="co"># the tag that will be pulled for testing</span>
  out_file <span class="op">=</span> <span class="st">"test_outputs/test_res"</span>, <span class="co"># basename for output .csv and .json files</span>
  set_id_to_name <span class="op">=</span> <span class="cn">TRUE</span>               <span class="co"># pass this only if _not_ using Test Id's (described below)</span>
<span class="op">)</span>

<span class="co"># pull Stories from Github issues</span>
<span class="va">stories_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_github_issues.html">parse_github_issues</a></span><span class="op">(</span>
  org <span class="op">=</span> <span class="st">"metrumresearchgroup"</span>,        <span class="co"># Github organization containing repo that will be validated</span>
  repo <span class="op">=</span> <span class="st">"mrgvalidatetestreference"</span>,  <span class="co"># repo for fake package used by mrgvalprep test suite</span>
  milestone <span class="op">=</span> <span class="st">"v0.6.0"</span>                <span class="co"># the name of the milestone in Github</span>
<span class="op">)</span>

<span class="co"># create the validation documents</span>
<span class="fu">mrgvalidate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mrgvalidate/man/create_validation_docs.html">create_validation_docs</a></span><span class="op">(</span>
  <span class="st">"mrgvalidatetestreference"</span>,       <span class="co"># name of the product or package you are validating</span>
  <span class="st">"0.6.0"</span>,                          <span class="co"># version number for this validation (to be printed in docs)</span>
  <span class="va">stories_df</span>,                       <span class="co"># tibble of stories from `parse_github_issues()`</span>
  auto_test_dir <span class="op">=</span> <span class="st">"test_outputs"</span>,   <span class="co"># dir containing test output .csv and .json files</span>
  output_dir <span class="op">=</span> <span class="st">"some_dir_for_docs"</span>  <span class="co"># dir to write validation docs into</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="initial-setup" class="section level3">
<h3 class="hasAnchor">
<a href="#initial-setup" class="anchor"></a>Initial setup</h3>
<p>Before proceeding, you will need to have <code>ghpm</code> installed on your system in order to interact with Github. This is an internal Metrum package that handles calls to the Github API. You can try <code><a href="https://rdrr.io/r/base/library.html">library(ghpm)</a></code> if you’re not sure if you have it. If you do not, install it with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"metrumresearchgroup/ghpm"</span><span class="op">)</span></code></pre></div>
<p>Next, you will need to make sure you have a valid token assigned to the relevant environment variable so that <code>ghpm</code> can access the Github API. Depending on whether the package you are validating is on Github Enterprise or public Github, you will either need to set <code>GHE_PAT</code> or <code>GITHUB_PAT</code> respectively. <strong>If you do not have a token</strong> please read an article like <a href="https://happygitwithr.com/github-pat.html#github-pat">this</a> for instuctions on getting one set up. Then use the following code to set the variable (substituting <code>GHE_PAT</code> if appropriate).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>GITHUB_PAT<span class="op">=</span><span class="st">"your-token"</span><span class="op">)</span> <span class="co"># "your-token" will be the alphanumeric OAuth token you get from Github</span></code></pre></div>
</div>
<div id="test-outputs-1" class="section level2">
<h2 class="hasAnchor">
<a href="#test-outputs-1" class="anchor"></a>Test outputs</h2>
<p>While you can call <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/parse_testthat_list_reporter.html"><code>parse_testthat_list_reporter()</code></a> directly, as shown in <a href="#example1">Example 1</a>, if you are validating an R package on Github it is likely easier to use the <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/validate_tests.html"><code>validate_tests()</code></a> wrapper. This does several things:</p>
<ul>
<li>Clones the repo of the package being validated from Github at a specified tag</li>
<li>Installs the package in a temp directory</li>
<li>Runs the package’s test suite with <code><a href="https://devtools.r-lib.org//reference/test.html">devtools::test(reporter = testthat::ListReporter)</a></code>
</li>
<li>Passes that output to <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/parse_testthat_list_reporter.html"><code>parse_testthat_list_reporter()</code></a> and writes the resulting tibble to a <code>.csv</code>
</li>
<li>Calls <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/get_sys_info.html"><code>get_sys_info()</code></a> to capture relevant system and user information, writing that to a <code>.json</code>
</li>
</ul>
<p>You will then put the resulting <code>.csv</code> and <code>.json</code> files into a directory that will be passed to the <code>auto_test_dir</code> argument of <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/validate_tests.html">validate_tests</a></span><span class="op">(</span>
  org <span class="op">=</span> <span class="st">"metrumresearchgroup"</span>,        <span class="co"># Github organization containing repo that will be validated</span>
  repo <span class="op">=</span> <span class="st">"mrgvalidatetestreference"</span>,  <span class="co"># repo for fake package used by mrgvalprep test suite</span>
  version <span class="op">=</span> <span class="st">"0.6.0"</span>,                  <span class="co"># the tag that will be pulled for testing</span>
  out_file <span class="op">=</span> <span class="st">"test_outputs/test_res"</span>, <span class="co"># basename for output .csv and .json files</span>
  set_id_to_name <span class="op">=</span> <span class="cn">TRUE</span>               <span class="co"># pass this only if _not_ using Test Id's (described below)</span>
<span class="op">)</span></code></pre></div>
<p>This call will write the <code>testthat</code> output to <code>test_res.csv</code> and the system info (including the commit hash of the git tag you pass to <code>version</code>) to <code>test_res.json</code>, both in the <code>test_outputs</code> directory.</p>
<div id="identifying-tests-in-code" class="section level3">
<h3 class="hasAnchor">
<a href="#identifying-tests-in-code" class="anchor"></a>Identifying tests in code</h3>
<p>To map tests to Stories, each test must be uniquely identified. The preferred method is to include Test Id’s in the Test Name within your code, as described in <a href="#example1">Example 1</a> above. However, it is also possible to match on the full Test Name (the full string passed as the first argument to <code>test_that()</code>). For example:</p>
<pre><code>test_that("feature X works correctly", {
  # test code
})</code></pre>
<p>In this case, <code>feature X works correctly</code> is the Test Name which will be passed through as a Test Id, if you pass <code><a href="../reference/validate_tests.html">validate_tests(..., set_id_to_name = TRUE)</a></code> as shown above. Your Stories can then reference this full string, as discussed in the next section. Note that, for mapping tests to Stories, <strong>you must either use Test Id’s <em>or</em> the full Test Names. It is <em>not</em> possible to mix between them</strong> within a test suite.</p>
<p>A few notes of caution on using full Test Names:</p>
<ul>
<li>All tests must have a unique name specified as the first arguement to the <code>test_that()</code> function (as in, no two tests have the same name).</li>
<li>If using the <code>describe()</code>/<code>it()</code> syntax in <code>testthat</code>, the Test Name will be the concatenation of the string passed to the outer <code>describe()</code> and the inner <code>it()</code>.</li>
<li>If you are using Test Names in your issues then, if you change the names of your tests in future versions, you will have to go back and change the names in the issues as well (as described in the “Issue format” section below). This is obviously toilsome and is one of the primary motivations for using Test Id’s instead.</li>
</ul>
<p>To reiterate, for these reasons and others, <strong>Test Id’s is the preferred method for mapping test outputs to Stories.</strong></p>
</div>
</div>
<div id="stories-from-github-issues" class="section level2">
<h2 class="hasAnchor">
<a href="#stories-from-github-issues" class="anchor"></a>Stories from Github issues</h2>
<p>You can define your Stories in Github issues, attached to a milestone, and <code>mrgvalprep</code> will pull them into a tibble that can be passed to <code>mrgvalidate</code>. However, doing this relies on the input data being structured in a predictable way:</p>
<div id="milestone" class="section level3">
<h3 class="hasAnchor">
<a href="#milestone" class="anchor"></a>Milestone</h3>
<p>All issues relevant to the release you are validating <em>must</em> be associated with the same milestone. This may be named the same as the tag for the release commit, but it does not need to be.</p>
<p>Note that this works well for validating a <em>change set</em>, but makes it difficult to validate the full functionality of the package (because <em>all</em> functionality would need to be represented in an issue on this milestone). If you need to validate the full functionality in single set of docs, consider using the Googlesheets method, shown in <a href="#example1">Example 1</a>.</p>
</div>
<div id="issue-format" class="section level3">
<h3 class="hasAnchor">
<a href="#issue-format" class="anchor"></a>Issue format</h3>
<p>The issue parser for creating validation documents requires a very specific format for <em>all</em> issues that are being validated (i.e. associated with the milestone discussed above).</p>
<ul>
<li>Summary section
<ul>
<li>There must be a top-level heading entitled <code># Summary</code>
</li>
<li>This should contain a “user story” describing the functionality</li>
</ul>
</li>
<li>Tests section
<ul>
<li>There must be a top-level heading entitled <code># Tests</code>
</li>
<li>This should contain a bulleted list of all the tests that are relevant to this functionality. This list can take two forms:
<ul>
<li>
<strong>Test Id’s</strong> – as described in <a href="#example1">Example 1</a>, you can list only the Test Id’s (like <code>XXX-XXX-123</code>) here, as long as those Test Id’s are contained in the <code>.csv</code> file created by <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/validate_tests.html"><code>validate_tests()</code></a>. See <a href="#example1">Example 1</a> above for how to included Test Id’s in your test suite code.</li>
<li>
<strong>Test Names</strong> – alternatively, you can pass the full text of the Test Name (i.e. the string passed as the first arguement to the <code>test_that()</code> function in your test code). As mentioned above, this method is <em>not</em> recommended because it relies on exact full string matching and is therefore more brittle than using Test Id’s. If you use this method, <strong>you will need to pass <code><a href="../reference/validate_tests.html">validate_tests(..., set_id_to_name = TRUE)</a></code></strong> as shown above.</li>
</ul>
</li>
<li>Note that <strong>if an issue has no tests</strong> associated with it, you <em>still</em> need a top-level heading entitled <code># Tests</code> but it should contain only some brief text about why tests are not necessary (with <em>no</em> leading bullets).</li>
</ul>
</li>
<li>Risk
<ul>
<li>All issues must have a label that conveys the level of product risk associated with this functionality.</li>
<li>Label must be formatted like <code>risk: ____</code>
</li>
</ul>
</li>
</ul>
<p>There should be no other top-level headings. Examples of correctly formatted issues can be seen in the <a href="https://github.com/metrumresearchgroup/mrgvalidatetestreference/issues">test reference repo</a> used by the <code>mrgvalprep</code> test suite.</p>
</div>
<div id="pulling-the-issues" class="section level3">
<h3 class="hasAnchor">
<a href="#pulling-the-issues" class="anchor"></a>Pulling the issues</h3>
<p>Once you have your issues formatted as described in the previous section, you can pull them into a tibble with <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/parse_github_issues.html"><code>parse_github_issues()</code></a>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stories_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_github_issues.html">parse_github_issues</a></span><span class="op">(</span>
  org <span class="op">=</span> <span class="st">"metrumresearchgroup"</span>,        <span class="co"># Github organization containing repo that will be validated</span>
  repo <span class="op">=</span> <span class="st">"mrgvalidatetestreference"</span>,  <span class="co"># repo for fake package used by mrgvalprep test suite</span>
  milestone <span class="op">=</span> <span class="st">"v0.6.0"</span>                <span class="co"># the name of the milestone in Github</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
<div id="generating-the-docs-1" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-the-docs-1" class="anchor"></a>Generating the docs</h2>
<p>Now that you have test outputs and a tibble of Stories, you are ready to generate your validation documents. This is done with <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
<p>You will have <code>.csv</code> and <code>.json</code> files of test output, from your <a href="https://metrumresearchgroup.github.io/mrgvalprep/reference/validate_tests.html"><code>validate_tests()</code></a> call above, in the <code>test_outputs</code> directory. Simply pass the path to that directory, along with your tibble of Stories, into <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mrgvalidate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mrgvalidate/man/create_validation_docs.html">create_validation_docs</a></span><span class="op">(</span>
  <span class="st">"mrgvalidatetestreference"</span>,       <span class="co"># name of the product or package you are validating</span>
  <span class="st">"0.6.0"</span>,                          <span class="co"># version number for this validation (to be printed in docs)</span>
  <span class="va">stories_df</span>,                       <span class="co"># tibble of stories from `parse_github_issues()`</span>
  auto_test_dir <span class="op">=</span> <span class="st">"test_outputs"</span>,   <span class="co"># dir containing test output .csv and .json files</span>
  output_dir <span class="op">=</span> <span class="st">"some_dir_for_docs"</span>  <span class="co"># dir to write validation docs into</span>
<span class="op">)</span></code></pre></div>
<p>This will write out three <code>.docx</code> files, as well as the <code>.md</code> files that are used to render each, into the directory passed to <code>output_dir</code>.</p>
<ul>
<li><code>validation-testing.docx</code></li>
<li><code>requirements-specification.docx</code></li>
<li><code>traceability-matrix.docx</code></li>
</ul>
<p>If these three documents look correct after human inspection, you’re done!</p>
<p><em>Formatting note:</em> You may want to manually adjust the column widths of the tables in these documents for better readability, especially so that each “Test Id” column value is on its own line. Unfortunately, it is not possible to programmatically specify these column widths. However, it is possible to pass <code>.docx</code> “style reference templates” via the <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html#arguments"><code>style_dir</code> argument</a> to <a href="https://metrumresearchgroup.github.io/mrgvalidate/reference/create_validation_docs.html"><code>mrgvalidate::create_validation_docs()</code></a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Pastoor, Seth Green, Kyle Meyer, Kyle T Baron, Sean Wilson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
